kjvm-objs := core/jem.o core/malloc.o 

# kjvm-objs := core/domain.o core/jem.o core/jemUPipe.o core/malloc.o core/jar.o \
#                core/thread.o core/load.o core/call.o core/libcache.o \
#                core/portal.o core/call.o core/exception_handler.o \
#		core/memfs.o core/sched.o core/symfind.o core/vmsupport.o \
#		dom0/zero.o dom0/zero_AtomicVariable.o dom0/zero_BootFS.o \
#		dom0/zero_CAS.o dom0/zero_Clock.o dom0/zero_ComponentManager.o \
#		dom0/zero_CPUManager.o dom0/zero_CPUState.o \
#		dom0/zero_Credential.o dom0/zero_Domain.o \
#		dom0/zero_DomainManager.o \
#               gc/gc.o gc/gc_alloc.o

ifeq ($(CONFIG_JEM_ENABLE_GC),y)
kjvm-objs += gc/gc_normal.o gc/gc_stack.o gc/gc_impl.o
endif


kjvm.o: $(kjvm-objs)
	$(LD) -r -o $@ $(kjvm-objs)

obj-$(CONFIG_JEM) += kjvm.o

EXTRA_CFLAGS += -I/opt/xenomai/include -Idrivers/embedded/kjvm/include -Idrivers/embedded/kcli -Idrivers/embedded/kcfg

